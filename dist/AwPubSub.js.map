{"version":3,"sources":["node_modules/browser-pack/_prelude.js","lib/AwPubSub.js"],"names":[],"mappings":"AAAA;;;;;;;ACAA;;;;;;AAMA;;AAEA;AACA;AACA;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,SAAS,QAAQ,QAAR,CAAb;;AAEA,IAAI,MAAM,OAAO,YAAP,CAAoB,EAAC,MAAK,UAAN,EAApB,CAAV;AACA;;AAEA;;;;IAGM,Q;AACH;;;AAGA,uBAAsE;AAAA,UAA1D,IAA0D,uEAAnD,eAAmD;AAAA,UAAlC,QAAkC,uEAAvB,MAAuB;AAAA,UAAf,IAAe,uEAAR,MAAQ;;AAAA;;AACnE,WAAK,KAAL,GAAgB,QAAhB,WAA8B,IAA9B;AACA,WAAK,KAAL,GAAa,IAAb;AACA,WAAK,SAAL,GAAiB,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAjB;AACA,WAAK,OAAL,GAAe,KAAK,OAAL,CAAa,IAAb,CAAkB,IAAlB,CAAf;AACF;;;;gCAEU;AACR,cAAK,UAAL,GAAkB,KAAK,OAAL,CAAa,KAAK,KAAlB,CAAlB;AACA,cAAK,UAAL,CAAgB,EAAhB,CAAmB,SAAnB,EAA8B,KAAK,SAAnC;AACA,cAAK,UAAL,CAAgB,EAAhB,CAAmB,OAAnB,EAA4B,KAAK,OAAjC;AACF;;;oCAEc;AACZ,gBAAO,KAAK,UAAL,CAAgB,SAAvB;AACF;;;kCAEY;AACV,aAAI,IAAJ,CAAS,WAAT;AACA,cAAK,UAAL,CAAgB,OAAhB,CAAwB,KAAK,KAA7B,EAAoC,KAAK,OAAzC;AACA,cAAK,OAAL;AACF;;;8BAEQ,K,EAAO;AACb,aAAI,IAAJ,eAAqB,KAArB;AACA,cAAK,MAAL,CAAY,KAAZ;AACF;;;8BAEQ,K,EAAO,O,EAAS;AAAA;;AACtB,aAAI,IAAJ,CAAS,SAAT;AACA,gBAAO,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;AACrC,kBAAK,OAAL,GAAe,OAAf;AACA,kBAAK,MAAL,GAAa,MAAb;AACA,kBAAK,KAAL,GAAa,KAAb;AACA,kBAAK,OAAL,GAAe,OAAf;AACA,kBAAK,OAAL;AACF,UANM,CAAP;AAOF;;;;;;AAGJ,OAAO,OAAP,GAAiB,QAAjB","file":"AwPubSub.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * @file\n * @copyright\n * @license\n *\n */\n/* eslint valid-jsdoc: [\"error\", {\"requireReturnDescription\": false}] */\n\n// import User from './User';\n// import Project from './Project';\n// import Instance from './Instance';\nvar mqtt = require('mqtt')\nvar bunyan = require('bunyan')\n\nvar log = bunyan.createLogger({name:'AwPubSub'})\n// var mqttClient\n\n/**\n * AwPubSub encapsulates the functionality to create various API wrapper objects.\n */\nclass AwPubSub {\n   /**\n    * Create a new AwPubSub.\n    */\n   constructor(host = 'apiway-pubsub', protocol = 'mqtt', port = '1883') {\n      this.__url = `${protocol}://${host}`\n      this._this = this\n      this.onConnect = this.onConnect.bind(this);\n      this.onError = this.onError.bind(this);\n   }\n\n   connect () {\n      this.mqttClient = mqtt.connect(this.__url)\n      this.mqttClient.on('connect', this.onConnect);\n      this.mqttClient.on('error', this.onError);\n   }\n\n   isConnected () {\n      return this.mqttClient.connected;\n   }\n\n   onConnect () {\n      log.info('onConnect')\n      this.mqttClient.publish(this.topic, this.message)\n      this.resolve()\n   }\n\n   onError (error) {\n      log.info(`onError: ${error}`)\n      this.reject(error)\n   }\n\n   publish (topic, message) {\n      log.info('publish')\n      return new Promise((resolve, reject) => {\n         this.resolve = resolve\n         this.reject= reject\n         this.topic = topic\n         this.message = message\n         this.connect()\n      })\n   }\n}\n\nmodule.exports = AwPubSub;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJsaWIvQXdQdWJTdWIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUNBQTs7Ozs7O0FBTUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSSxPQUFPLFFBQVEsTUFBUixDQUFYO0FBQ0EsSUFBSSxTQUFTLFFBQVEsUUFBUixDQUFiOztBQUVBLElBQUksTUFBTSxPQUFPLFlBQVAsQ0FBb0IsRUFBQyxNQUFLLFVBQU4sRUFBcEIsQ0FBVjtBQUNBOztBQUVBOzs7O0lBR00sUTtBQUNIOzs7QUFHQSx1QkFBc0U7QUFBQSxVQUExRCxJQUEwRCx1RUFBbkQsZUFBbUQ7QUFBQSxVQUFsQyxRQUFrQyx1RUFBdkIsTUFBdUI7QUFBQSxVQUFmLElBQWUsdUVBQVIsTUFBUTs7QUFBQTs7QUFDbkUsV0FBSyxLQUFMLEdBQWdCLFFBQWhCLFdBQThCLElBQTlCO0FBQ0EsV0FBSyxLQUFMLEdBQWEsSUFBYjtBQUNBLFdBQUssU0FBTCxHQUFpQixLQUFLLFNBQUwsQ0FBZSxJQUFmLENBQW9CLElBQXBCLENBQWpCO0FBQ0EsV0FBSyxPQUFMLEdBQWUsS0FBSyxPQUFMLENBQWEsSUFBYixDQUFrQixJQUFsQixDQUFmO0FBQ0Y7Ozs7Z0NBRVU7QUFDUixjQUFLLFVBQUwsR0FBa0IsS0FBSyxPQUFMLENBQWEsS0FBSyxLQUFsQixDQUFsQjtBQUNBLGNBQUssVUFBTCxDQUFnQixFQUFoQixDQUFtQixTQUFuQixFQUE4QixLQUFLLFNBQW5DO0FBQ0EsY0FBSyxVQUFMLENBQWdCLEVBQWhCLENBQW1CLE9BQW5CLEVBQTRCLEtBQUssT0FBakM7QUFDRjs7O29DQUVjO0FBQ1osZ0JBQU8sS0FBSyxVQUFMLENBQWdCLFNBQXZCO0FBQ0Y7OztrQ0FFWTtBQUNWLGFBQUksSUFBSixDQUFTLFdBQVQ7QUFDQSxjQUFLLFVBQUwsQ0FBZ0IsT0FBaEIsQ0FBd0IsS0FBSyxLQUE3QixFQUFvQyxLQUFLLE9BQXpDO0FBQ0EsY0FBSyxPQUFMO0FBQ0Y7Ozs4QkFFUSxLLEVBQU87QUFDYixhQUFJLElBQUosZUFBcUIsS0FBckI7QUFDQSxjQUFLLE1BQUwsQ0FBWSxLQUFaO0FBQ0Y7Ozs4QkFFUSxLLEVBQU8sTyxFQUFTO0FBQUE7O0FBQ3RCLGFBQUksSUFBSixDQUFTLFNBQVQ7QUFDQSxnQkFBTyxJQUFJLE9BQUosQ0FBWSxVQUFDLE9BQUQsRUFBVSxNQUFWLEVBQXFCO0FBQ3JDLGtCQUFLLE9BQUwsR0FBZSxPQUFmO0FBQ0Esa0JBQUssTUFBTCxHQUFhLE1BQWI7QUFDQSxrQkFBSyxLQUFMLEdBQWEsS0FBYjtBQUNBLGtCQUFLLE9BQUwsR0FBZSxPQUFmO0FBQ0Esa0JBQUssT0FBTDtBQUNGLFVBTk0sQ0FBUDtBQU9GOzs7Ozs7QUFHSixPQUFPLE9BQVAsR0FBaUIsUUFBakIiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqXG4gKiBAZmlsZVxuICogQGNvcHlyaWdodFxuICogQGxpY2Vuc2VcbiAqXG4gKi9cbi8qIGVzbGludCB2YWxpZC1qc2RvYzogW1wiZXJyb3JcIiwge1wicmVxdWlyZVJldHVybkRlc2NyaXB0aW9uXCI6IGZhbHNlfV0gKi9cblxuLy8gaW1wb3J0IFVzZXIgZnJvbSAnLi9Vc2VyJztcbi8vIGltcG9ydCBQcm9qZWN0IGZyb20gJy4vUHJvamVjdCc7XG4vLyBpbXBvcnQgSW5zdGFuY2UgZnJvbSAnLi9JbnN0YW5jZSc7XG52YXIgbXF0dCA9IHJlcXVpcmUoJ21xdHQnKVxudmFyIGJ1bnlhbiA9IHJlcXVpcmUoJ2J1bnlhbicpXG5cbnZhciBsb2cgPSBidW55YW4uY3JlYXRlTG9nZ2VyKHtuYW1lOidBd1B1YlN1Yid9KVxuLy8gdmFyIG1xdHRDbGllbnRcblxuLyoqXG4gKiBBd1B1YlN1YiBlbmNhcHN1bGF0ZXMgdGhlIGZ1bmN0aW9uYWxpdHkgdG8gY3JlYXRlIHZhcmlvdXMgQVBJIHdyYXBwZXIgb2JqZWN0cy5cbiAqL1xuY2xhc3MgQXdQdWJTdWIge1xuICAgLyoqXG4gICAgKiBDcmVhdGUgYSBuZXcgQXdQdWJTdWIuXG4gICAgKi9cbiAgIGNvbnN0cnVjdG9yKGhvc3QgPSAnYXBpd2F5LXB1YnN1YicsIHByb3RvY29sID0gJ21xdHQnLCBwb3J0ID0gJzE4ODMnKSB7XG4gICAgICB0aGlzLl9fdXJsID0gYCR7cHJvdG9jb2x9Oi8vJHtob3N0fWBcbiAgICAgIHRoaXMuX3RoaXMgPSB0aGlzXG4gICAgICB0aGlzLm9uQ29ubmVjdCA9IHRoaXMub25Db25uZWN0LmJpbmQodGhpcyk7XG4gICAgICB0aGlzLm9uRXJyb3IgPSB0aGlzLm9uRXJyb3IuYmluZCh0aGlzKTtcbiAgIH1cblxuICAgY29ubmVjdCAoKSB7XG4gICAgICB0aGlzLm1xdHRDbGllbnQgPSBtcXR0LmNvbm5lY3QodGhpcy5fX3VybClcbiAgICAgIHRoaXMubXF0dENsaWVudC5vbignY29ubmVjdCcsIHRoaXMub25Db25uZWN0KTtcbiAgICAgIHRoaXMubXF0dENsaWVudC5vbignZXJyb3InLCB0aGlzLm9uRXJyb3IpO1xuICAgfVxuXG4gICBpc0Nvbm5lY3RlZCAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tcXR0Q2xpZW50LmNvbm5lY3RlZDtcbiAgIH1cblxuICAgb25Db25uZWN0ICgpIHtcbiAgICAgIGxvZy5pbmZvKCdvbkNvbm5lY3QnKVxuICAgICAgdGhpcy5tcXR0Q2xpZW50LnB1Ymxpc2godGhpcy50b3BpYywgdGhpcy5tZXNzYWdlKVxuICAgICAgdGhpcy5yZXNvbHZlKClcbiAgIH1cblxuICAgb25FcnJvciAoZXJyb3IpIHtcbiAgICAgIGxvZy5pbmZvKGBvbkVycm9yOiAke2Vycm9yfWApXG4gICAgICB0aGlzLnJlamVjdChlcnJvcilcbiAgIH1cblxuICAgcHVibGlzaCAodG9waWMsIG1lc3NhZ2UpIHtcbiAgICAgIGxvZy5pbmZvKCdwdWJsaXNoJylcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlXG4gICAgICAgICB0aGlzLnJlamVjdD0gcmVqZWN0XG4gICAgICAgICB0aGlzLnRvcGljID0gdG9waWNcbiAgICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2VcbiAgICAgICAgIHRoaXMuY29ubmVjdCgpXG4gICAgICB9KVxuICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEF3UHViU3ViO1xuIl19"}